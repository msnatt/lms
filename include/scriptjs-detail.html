<!-- page product -->
<script>
    document.addEventListener('DOMContentLoaded', async () => {

        const urlParams = new URLSearchParams(window.location.search);
        const courseID = urlParams.get('courseid');
        console.log("Course id:", courseID);

        const response = await fetch('../config/Fetch_Course.php'); // เรียกใช้ PHP
        const json_res = await response.json(); // รับผลลัพธ์เป็น JSON
        let Courses = json_res;
        const response_unit = await fetch('../config/Fetch_Unit.php'); // เรียกใช้ PHP
        const json_res_unit = await response_unit.json(); // รับผลลัพธ์เป็น JSON
        let Units = json_res_unit;
        const response_content = await fetch('../config/Fetch_content.php'); // เรียกใช้ PHP
        const json_res_content = await response_content.json(); // รับผลลัพธ์เป็น JSON
        let Contents = json_res_content;

        const detail_div = document.getElementById("detail_div");

        for (let i = 0; i < Units.length; i++) {
            const unit = Units[i];
            if (courseID == unit.course_id) {
                // สร้าง container หลัก
                const unitDiv = document.createElement("div");
                unitDiv.style.marginBottom = "10px";

                // ปุ่ม Toggle
                const toggleBtn = document.createElement("div");
                toggleBtn.textContent = unit.name;
                toggleBtn.style.cursor = "pointer";
                toggleBtn.style.marginBottom = "5px";
                toggleBtn.style.backgroundColor = "#FFFFFF";
                toggleBtn.style.fontSize = "2rem";
                toggleBtn.style.transition = "background-color 0.3s ease";

                // กล่องเนื้อหา (ซ่อนไว้ก่อน)
                const contentDiv = document.createElement("div");
                contentDiv.style.display = "none";
                contentDiv.innerHTML = `
                <div padding: 10px;">
                    ${unit.name}
                </div>
                `;

                // เพิ่ม Event Listener สำหรับการซ่อน/แสดง
                toggleBtn.addEventListener("click", () => {
                    const isVisible = contentDiv.style.display === "block";
                    contentDiv.style.display = isVisible ? "none" : "block";
                    toggleBtn.style.backgroundColor = isVisible ? "#FFFFFF" : "#DDDDDD"; // เขียว-แดง
                });

                // ใส่ปุ่มและเนื้อหาเข้าไปใน container หลัก
                unitDiv.appendChild(toggleBtn);
                unitDiv.appendChild(contentDiv);

                // เพิ่มเข้าไปใน detail_div
                detail_div.appendChild(unitDiv);
            }

        };










        // // ฟังก์ชันแสดงสินค้า
        // function renderProducts(page) {
        //     const startIndex = (page - 1) * productsPerPage;
        //     const endIndex = startIndex + productsPerPage;
        //     const visibleCourse = Courses.slice(startIndex, endIndex);

        //     const course_div = document.getElementById("course_div");
        //     course_div.innerHTML = visibleCourse.map(course => `
        //     <div class="col-12 col-md-6 col-lg-4 d-flex justify-content-center">
        //         <div class="card h-100" onclick="handleCardClick('${course.id}')">
        //             <img src="../assets/images/bg_cards/${course.image_code}.png" class="card-img-top" alt="img-${course.name}">
        //             <div class="card-body">
        //                 <h5 class="card-title fw-bold">${course.code} ${course.name}</h5>
        //                 <p class="">${course.description}</p>
        //             </div>
        //         </div>
        //     </div>
        // `).join("");

        //     // คำนวณจำนวนหน้าสูงสุด
        //     const totalPages = Math.ceil(Courses.length / productsPerPage);
        //     document.getElementById("total-pages").textContent = totalPages;

        //     // อัปเดตปุ่ม Pagination
        //     document.getElementById("current-page").textContent = currentPage;
        //     document.getElementById("prev-page").disabled = currentPage === 1;
        //     document.getElementById("next-page").disabled = currentPage === totalPages;
        // }

        // // Event Listeners
        // document.getElementById("prev-page").addEventListener("click", () => changePage(-1));
        // document.getElementById("next-page").addEventListener("click", () => changePage(1));
        // window.addEventListener('resize', updateProductsPerPage);

        // // เริ่มต้น
        // updateProductsPerPage();
    });

    function handleCardClick(course_id) {
        window.location.href = `../pages/detail.php?courseCode=${courseCode}`;
        // alert('You clicked on course: ' + course_id);
    }

</script>